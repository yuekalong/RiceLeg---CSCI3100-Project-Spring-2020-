{"remainingRequest":"/Users/yuekalong/Desktop/Year 3 Sem 2/CSCI3100/Project/RiceLeg---CSCI3100-Project-Spring-2020-/front_end/node_modules/babel-loader/lib/index.js!/Users/yuekalong/Desktop/Year 3 Sem 2/CSCI3100/Project/RiceLeg---CSCI3100-Project-Spring-2020-/front_end/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/Users/yuekalong/Desktop/Year 3 Sem 2/CSCI3100/Project/RiceLeg---CSCI3100-Project-Spring-2020-/front_end/src/router.js","dependencies":[{"path":"/Users/yuekalong/Desktop/Year 3 Sem 2/CSCI3100/Project/RiceLeg---CSCI3100-Project-Spring-2020-/front_end/src/router.js","mtime":1589641334000},{"path":"/Users/yuekalong/Desktop/Year 3 Sem 2/CSCI3100/Project/RiceLeg---CSCI3100-Project-Spring-2020-/front_end/node_modules/cache-loader/dist/cjs.js","mtime":1583842195418},{"path":"/Users/yuekalong/Desktop/Year 3 Sem 2/CSCI3100/Project/RiceLeg---CSCI3100-Project-Spring-2020-/front_end/node_modules/babel-loader/lib/index.js","mtime":1573785088708},{"path":"/Users/yuekalong/Desktop/Year 3 Sem 2/CSCI3100/Project/RiceLeg---CSCI3100-Project-Spring-2020-/front_end/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1573785097475}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.find\";\nimport _Date$now from \"/Users/yuekalong/Desktop/Year 3 Sem 2/CSCI3100/Project/RiceLeg---CSCI3100-Project-Spring-2020-/front_end/node_modules/@babel/runtime-corejs2/core-js/date/now\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/yuekalong/Desktop/Year 3 Sem 2/CSCI3100/Project/RiceLeg---CSCI3100-Project-Spring-2020-/front_end/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n\n/*\n * MODULE NAME: ROUTER\n * PROGRAMMER: YUE KA LONG\n * VERSION: 1.0 (16 MAY 2020)\n *\n * PURPOSE: THIS IS THE VUE ROUTER DOCUMENT WHICH HELPS TO MANAGE THE ROUTES\n *\n */\nimport Vue from \"vue\";\nimport Router from \"vue-router\";\nimport store from \"@/store\";\nVue.use(Router); // check the user logged in or not\n\nvar loggedIn =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee() {\n    var logged;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return store.dispatch(\"restoreSession\");\n\n          case 3:\n            logged = _context.sent;\n\n            if (!logged) {\n              _context.next = 8;\n              break;\n            }\n\n            return _context.abrupt(\"return\", true);\n\n          case 8:\n            return _context.abrupt(\"return\", false);\n\n          case 9:\n            _context.next = 14;\n            break;\n\n          case 11:\n            _context.prev = 11;\n            _context.t0 = _context[\"catch\"](0);\n            return _context.abrupt(\"return\", false);\n\n          case 14:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, this, [[0, 11]]);\n  }));\n\n  return function loggedIn() {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar router = new Router({\n  mode: \"history\",\n  // ensure no refresh during page changes\n  base: process.env.BASE_URL,\n  // set the base url here (which should be localhost:3000)\n  routes: [{\n    path: \"/\",\n    name: \"home\",\n    component: function component() {\n      return import(\"@/views/Home.vue\");\n    },\n    // import the vue component which is the home page of the application\n    meta: {\n      showToolBar: true,\n      // set the toolbar to be visible\n      showFooter: true // set the footer to be visible\n\n    },\n    beforeEnter: function () {\n      var _beforeEnter = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(to, from, next) {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return loggedIn();\n\n              case 2:\n                // check the user logged in or not\n                next(); // allow to go in home page\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function beforeEnter(_x, _x2, _x3) {\n        return _beforeEnter.apply(this, arguments);\n      }\n\n      return beforeEnter;\n    }()\n  }, {\n    path: \"/login\",\n    name: \"Login\",\n    component: function component() {\n      return import(\"@/views/Login.vue\");\n    },\n    // import the vue component which is the login page of the application\n    meta: {\n      showToolBar: false,\n      // set the toolbar to be disappeared\n      showFooter: false // set the footer to be disappeared\n\n    },\n    beforeEnter: function () {\n      var _beforeEnter2 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3(to, from, next) {\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return loggedIn();\n\n              case 2:\n                if (!_context3.sent) {\n                  _context3.next = 4;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", next(\"/\"));\n\n              case 4:\n                next(); // else allow to go in login page\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function beforeEnter(_x4, _x5, _x6) {\n        return _beforeEnter2.apply(this, arguments);\n      }\n\n      return beforeEnter;\n    }()\n  }, {\n    path: \"/sign_up\",\n    name: \"Sign Up\",\n    component: function component() {\n      return import(\"@/views/SignUp.vue\");\n    },\n    // import the vue component which is the sign up page of the application\n    meta: {\n      showToolBar: false,\n      // set the toolbar to be disappeared\n      showFooter: false // set the footer to be disappeared\n\n    },\n    beforeEnter: function () {\n      var _beforeEnter3 = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee4(to, from, next) {\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return loggedIn();\n\n              case 2:\n                if (!_context4.sent) {\n                  _context4.next = 4;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", next(\"/\"));\n\n              case 4:\n                next(); // else allow to go in login page\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function beforeEnter(_x7, _x8, _x9) {\n        return _beforeEnter3.apply(this, arguments);\n      }\n\n      return beforeEnter;\n    }()\n  }, {\n    path: \"/profile\",\n    name: \"profile\",\n    component: function component() {\n      return import(\"@/views/Profile.vue\");\n    },\n    // import the vue component which is the Profile page of the application\n    meta: {\n      showToolBar: true,\n      // set the toolbar to be visible\n      showFooter: true,\n      // set the footer to be visible\n      requiresAuth: true // required login before entering this page, if not , user cannot go in this page\n\n    }\n  }, {\n    path: \"/restaurant\",\n    name: \"Restaurant\",\n    component: function component() {\n      return import(\"@/views/RestaurantDisplay.vue\");\n    },\n    // import the vue component which is the Restaurant Display page of the application\n    meta: {\n      showToolBar: true,\n      // set the toolbar to be visible\n      showFooter: true,\n      // set the footer to be visible\n      requiresAuth: true // required login before entering this page, if not , user cannot go in this page\n\n    }\n  }, {\n    path: \"/matching\",\n    name: \"Matching\",\n    component: function component() {\n      return import(\"@/views/Matching.vue\");\n    },\n    // import the vue component which is the Matching page of the application\n    meta: {\n      showToolBar: true,\n      // set the toolbar to be visible\n      showFooter: true,\n      // set the footer to be visible\n      requiresAuth: true // required login before entering this page, if not , user cannot go in this page\n\n    }\n  }, {\n    path: \"/chatroom\",\n    name: \"Chatroom\",\n    component: function component() {\n      return import(\"@/views/Chatroom.vue\");\n    },\n    // import the vue component which is the Chatroom page of the application\n    meta: {\n      showToolBar: true,\n      // set the toolbar to be visible\n      showFooter: true,\n      // set the footer to be visible\n      requiresAuth: true // required login before entering this page, if not , user cannot go in this page\n\n    }\n  }]\n}); // before each time it change the route\n\nrouter.beforeEach(\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee5(to, from, next) {\n    var stateLoggedIn, expiryTime;\n    return regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            if (!(to.path === \"/\")) {\n              _context5.next = 4;\n              break;\n            }\n\n            next();\n            _context5.next = 18;\n            break;\n\n          case 4:\n            stateLoggedIn = store.state.loggedIn; // get the state loggedIn\n\n            expiryTime = store.state.expiryTime; // get the state expiryTime\n            // check the user have logged in or not and it is expired or not\n\n            if (!(stateLoggedIn && expiryTime > Math.floor(_Date$now() / 1000))) {\n              _context5.next = 10;\n              break;\n            }\n\n            // if logged in\n            // if the path is not login or sign_up it can be go\n            if (to.path !== \"/login\" && to.path !== \"/sign_up\") next();else next(\"/matching\"); // else go to matching route\n\n            _context5.next = 18;\n            break;\n\n          case 10:\n            _context5.next = 12;\n            return loggedIn();\n\n          case 12:\n            if (!_context5.sent) {\n              _context5.next = 16;\n              break;\n            }\n\n            // ensure when state disappear for some kind of reason, check again\n            // if the path is not login or sign_up it can be go\n            if (to.path !== \"/login\" && to.path !== \"/sign_up\") next();\n            _context5.next = 18;\n            break;\n\n          case 16:\n            // if the path is not login or sign_up it can be go\n            if (to.path === \"/login\" || to.path === \"/sign_up\") next(); // if the log in expired\n            else if (expiryTime <= Math.floor(_Date$now() / 1000)) {\n                alert(\"Session expired!\"); // alert session expired\n              } // commit logout\n\n            store.commit(\"logout\");\n\n          case 18:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5, this);\n  }));\n\n  return function (_x10, _x11, _x12) {\n    return _ref2.apply(this, arguments);\n  };\n}()); // before loading the page to display\n\nrouter.beforeResolve(function (to, from, next) {\n  try {\n    var showToolBar = to.matched.slice().reverse().find(function (m) {\n      return typeof m.meta.showToolBar !== \"undefined\";\n    }); // check the Toolbar should be show or not\n\n    var showFooter = to.matched.slice().reverse().find(function (m) {\n      return typeof m.meta.showFooter !== \"undefined\";\n    }); // check the Footer should be show or not\n    // assign the value to the state\n\n    store.commit(\"showToolBar\", showToolBar ? showToolBar.meta.showToolBar : true);\n    store.commit(\"showFooter\", showFooter ? showFooter.meta.showFooter : true);\n  } catch (error) {}\n\n  next();\n});\nexport default router;",{"version":3,"sources":["/Users/yuekalong/Desktop/Year 3 Sem 2/CSCI3100/Project/RiceLeg---CSCI3100-Project-Spring-2020-/front_end/src/router.js"],"names":["Vue","Router","store","use","loggedIn","dispatch","logged","router","mode","base","process","env","BASE_URL","routes","path","name","component","meta","showToolBar","showFooter","beforeEnter","to","from","next","requiresAuth","beforeEach","stateLoggedIn","state","expiryTime","Math","floor","alert","commit","beforeResolve","matched","slice","reverse","find","m","error"],"mappings":"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","sourcesContent":["/*\n * MODULE NAME: ROUTER\n * PROGRAMMER: YUE KA LONG\n * VERSION: 1.0 (16 MAY 2020)\n *\n * PURPOSE: THIS IS THE VUE ROUTER DOCUMENT WHICH HELPS TO MANAGE THE ROUTES\n *\n */\nimport Vue from \"vue\";\nimport Router from \"vue-router\";\nimport store from \"@/store\";\n\nVue.use(Router);\n\n// check the user logged in or not\nconst loggedIn = async () => {\n  try {\n    const logged = await store.dispatch(\"restoreSession\");\n    if (logged) {\n      return true;\n    } else {\n      return false;\n    }\n  } catch (error) {\n    return false;\n  }\n};\n\nconst router = new Router({\n  mode: \"history\", // ensure no refresh during page changes\n  base: process.env.BASE_URL, // set the base url here (which should be localhost:3000)\n  routes: [\n    {\n      path: \"/\",\n      name: \"home\",\n      component: () => import(\"@/views/Home.vue\"), // import the vue component which is the home page of the application\n      meta: {\n        showToolBar: true, // set the toolbar to be visible\n        showFooter: true // set the footer to be visible\n      },\n      beforeEnter: async (to, from, next) => {\n        await loggedIn(); // check the user logged in or not\n        next(); // allow to go in home page\n      }\n    },\n    {\n      path: \"/login\",\n      name: \"Login\",\n      component: () => import(\"@/views/Login.vue\"), // import the vue component which is the login page of the application\n      meta: {\n        showToolBar: false, // set the toolbar to be disappeared\n        showFooter: false // set the footer to be disappeared\n      },\n      beforeEnter: async (to, from, next) => {\n        // check it logged in or not\n        if (await loggedIn()) {\n          return next(\"/\"); //if logged in redirect to home page because no more login should be allowed\n        }\n        next(); // else allow to go in login page\n      }\n    },\n    {\n      path: \"/sign_up\",\n      name: \"Sign Up\",\n      component: () => import(\"@/views/SignUp.vue\"), // import the vue component which is the sign up page of the application\n      meta: {\n        showToolBar: false, // set the toolbar to be disappeared\n        showFooter: false // set the footer to be disappeared\n      },\n      beforeEnter: async (to, from, next) => {\n        // check it logged in or not\n        if (await loggedIn()) {\n          return next(\"/\"); // if logged in redirect to home page because no more login should be allowed\n        }\n        next(); // else allow to go in login page\n      }\n    },\n    {\n      path: \"/profile\",\n      name: \"profile\",\n      component: () => import(\"@/views/Profile.vue\"), // import the vue component which is the Profile page of the application\n      meta: {\n        showToolBar: true, // set the toolbar to be visible\n        showFooter: true, // set the footer to be visible\n        requiresAuth: true // required login before entering this page, if not , user cannot go in this page\n      }\n    },\n    {\n      path: \"/restaurant\",\n      name: \"Restaurant\",\n      component: () => import(\"@/views/RestaurantDisplay.vue\"), // import the vue component which is the Restaurant Display page of the application\n      meta: {\n        showToolBar: true, // set the toolbar to be visible\n        showFooter: true, // set the footer to be visible\n        requiresAuth: true // required login before entering this page, if not , user cannot go in this page\n      }\n    },\n    {\n      path: \"/matching\",\n      name: \"Matching\",\n      component: () => import(\"@/views/Matching.vue\"), // import the vue component which is the Matching page of the application\n      meta: {\n        showToolBar: true, // set the toolbar to be visible\n        showFooter: true, // set the footer to be visible\n        requiresAuth: true // required login before entering this page, if not , user cannot go in this page\n      }\n    },\n    {\n      path: \"/chatroom\",\n      name: \"Chatroom\",\n      component: () => import(\"@/views/Chatroom.vue\"), // import the vue component which is the Chatroom page of the application\n      meta: {\n        showToolBar: true, // set the toolbar to be visible\n        showFooter: true, // set the footer to be visible\n        requiresAuth: true // required login before entering this page, if not , user cannot go in this page\n      }\n    }\n  ]\n});\n\n// before each time it change the route\nrouter.beforeEach(async (to, from, next) => {\n  // if want to go home page, no need authenication\n  if (to.path === \"/\") next();\n  else {\n    let stateLoggedIn = store.state.loggedIn; // get the state loggedIn\n    const expiryTime = store.state.expiryTime; // get the state expiryTime\n\n    // check the user have logged in or not and it is expired or not\n    if (stateLoggedIn && expiryTime > Math.floor(Date.now() / 1000)) {\n      // if logged in\n      // if the path is not login or sign_up it can be go\n      if (to.path !== \"/login\" && to.path !== \"/sign_up\") next();\n      else next(\"/matching\"); // else go to matching route\n    } else if (await loggedIn()) {\n      // ensure when state disappear for some kind of reason, check again\n      // if the path is not login or sign_up it can be go\n      if (to.path !== \"/login\" && to.path !== \"/sign_up\") next();\n    } else {\n      // if the path is not login or sign_up it can be go\n      if (to.path === \"/login\" || to.path === \"/sign_up\") next();\n      // if the log in expired\n      else if (expiryTime <= Math.floor(Date.now() / 1000)) {\n        alert(\"Session expired!\"); // alert session expired\n      }\n      // commit logout\n      store.commit(\"logout\");\n    }\n  }\n});\n\n// before loading the page to display\nrouter.beforeResolve((to, from, next) => {\n  try {\n    let showToolBar = to.matched\n      .slice()\n      .reverse()\n      .find(m => typeof m.meta.showToolBar !== \"undefined\"); // check the Toolbar should be show or not\n    let showFooter = to.matched\n      .slice()\n      .reverse()\n      .find(m => typeof m.meta.showFooter !== \"undefined\"); // check the Footer should be show or not\n\n    // assign the value to the state\n    store.commit(\n      \"showToolBar\",\n      showToolBar ? showToolBar.meta.showToolBar : true\n    );\n    store.commit(\"showFooter\", showFooter ? showFooter.meta.showFooter : true);\n  } catch (error) {}\n  next();\n});\nexport default router;\n"]}]}